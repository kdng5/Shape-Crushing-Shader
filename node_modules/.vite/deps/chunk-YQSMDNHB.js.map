{
  "version": 3,
  "sources": ["../../three/examples/jsm/shaders/FilmShader.js", "../../three/examples/jsm/postprocessing/FilmPass.js"],
  "sourcesContent": ["/**\r\n * @module FilmShader\r\n * @three_import import { FilmShader } from 'three/addons/shaders/FilmShader.js';\r\n */\r\n\r\n/**\r\n * TODO\r\n *\r\n * Used by {@link FilmPass}.\r\n *\r\n * @constant\r\n * @type {ShaderMaterial~Shader}\r\n */\r\nconst FilmShader = {\r\n\r\n\tname: 'FilmShader',\r\n\r\n\tuniforms: {\r\n\r\n\t\t'tDiffuse': { value: null },\r\n\t\t'time': { value: 0.0 },\r\n\t\t'intensity': { value: 0.5 },\r\n\t\t'grayscale': { value: false }\r\n\r\n\t},\r\n\r\n\tvertexShader: /* glsl */`\r\n\r\n\t\tvarying vec2 vUv;\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\tvUv = uv;\r\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n\r\n\t\t}`,\r\n\r\n\tfragmentShader: /* glsl */`\r\n\r\n\t\t#include <common>\r\n\r\n\t\tuniform float intensity;\r\n\t\tuniform bool grayscale;\r\n\t\tuniform float time;\r\n\r\n\t\tuniform sampler2D tDiffuse;\r\n\r\n\t\tvarying vec2 vUv;\r\n\r\n\t\tvoid main() {\r\n\r\n\t\t\tvec4 base = texture2D( tDiffuse, vUv );\r\n\r\n\t\t\tfloat noise = rand( fract( vUv + time ) );\r\n\r\n\t\t\tvec3 color = base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );\r\n\r\n\t\t\tcolor = mix( base.rgb, color, intensity );\r\n\r\n\t\t\tif ( grayscale ) {\r\n\r\n\t\t\t\tcolor = vec3( luminance( color ) ); // assuming linear-srgb\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgl_FragColor = vec4( color, base.a );\r\n\r\n\t\t}`,\r\n\r\n};\r\n\r\nexport { FilmShader };\r\n", "import {\r\n\tShaderMaterial,\r\n\tUniformsUtils\r\n} from 'three';\r\nimport { Pass, FullScreenQuad } from './Pass.js';\r\nimport { FilmShader } from '../shaders/FilmShader.js';\r\n\r\n/**\r\n * This pass can be used to create a film grain effect.\r\n *\r\n * ```js\r\n * const filmPass = new FilmPass();\r\n * composer.addPass( filmPass );\r\n * ```\r\n *\r\n * @augments Pass\r\n * @three_import import { FilmPass } from 'three/addons/postprocessing/FilmPass.js';\r\n */\r\nclass FilmPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new film pass.\r\n\t *\r\n\t * @param {number} [intensity=0.5] - The grain intensity in the range `[0,1]` (0 = no effect, 1 = full effect).\r\n\t * @param {boolean} [grayscale=false] - Whether to apply a grayscale effect or not.\r\n\t */\r\n\tconstructor( intensity = 0.5, grayscale = false ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tconst shader = FilmShader;\r\n\r\n\t\t/**\r\n\t\t * The pass uniforms. Use this object if you want to update the\r\n\t\t * `intensity` or `grayscale` values at runtime.\r\n\t\t * ```js\r\n\t\t * pass.uniforms.intensity.value = 1;\r\n\t\t * pass.uniforms.grayscale.value = true;\r\n\t\t * ```\r\n\t\t *\r\n\t\t * @type {Object}\r\n\t\t */\r\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\r\n\r\n\t\t/**\r\n\t\t * The pass material.\r\n\t\t *\r\n\t\t * @type {ShaderMaterial}\r\n\t\t */\r\n\t\tthis.material = new ShaderMaterial( {\r\n\r\n\t\t\tname: shader.name,\r\n\t\t\tuniforms: this.uniforms,\r\n\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\tfragmentShader: shader.fragmentShader\r\n\r\n\t\t} );\r\n\r\n\t\tthis.uniforms.intensity.value = intensity;\r\n\t\tthis.uniforms.grayscale.value = grayscale;\r\n\r\n\t\t// internals\r\n\r\n\t\tthis._fsQuad = new FullScreenQuad( this.material );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs the film pass.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} writeBuffer - The write buffer. This buffer is intended as the rendering\r\n\t * destination for the pass.\r\n\t * @param {WebGLRenderTarget} readBuffer - The read buffer. The pass can access the result from the\r\n\t * previous pass from this buffer.\r\n\t * @param {number} deltaTime - The delta time in seconds.\r\n\t * @param {boolean} maskActive - Whether masking is active or not.\r\n\t */\r\n\trender( renderer, writeBuffer, readBuffer, deltaTime /*, maskActive */ ) {\r\n\r\n\t\tthis.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\r\n\t\tthis.uniforms[ 'time' ].value += deltaTime;\r\n\r\n\t\tif ( this.renderToScreen ) {\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\t\tthis._fsQuad.render( renderer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.setRenderTarget( writeBuffer );\r\n\t\t\tif ( this.clear ) renderer.clear();\r\n\t\t\tthis._fsQuad.render( renderer );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Frees the GPU-related resources allocated by this instance. Call this\r\n\t * method whenever the pass is no longer used in your app.\r\n\t */\r\n\tdispose() {\r\n\r\n\t\tthis.material.dispose();\r\n\r\n\t\tthis._fsQuad.dispose();\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { FilmPass };\r\n"],
  "mappings": ";;;;;;;;;;AAaA,IAAM,aAAa;AAAA,EAElB,MAAM;AAAA,EAEN,UAAU;AAAA,IAET,YAAY,EAAE,OAAO,KAAK;AAAA,IAC1B,QAAQ,EAAE,OAAO,EAAI;AAAA,IACrB,aAAa,EAAE,OAAO,IAAI;AAAA,IAC1B,aAAa,EAAE,OAAO,MAAM;AAAA,EAE7B;AAAA,EAEA;AAAA;AAAA,IAAwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWxB;AAAA;AAAA,IAA0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgC3B;;;ACnDA,IAAM,WAAN,cAAuB,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQ3B,YAAa,YAAY,KAAK,YAAY,OAAQ;AAEjD,UAAM;AAEN,UAAM,SAAS;AAYf,SAAK,WAAW,cAAc,MAAO,OAAO,QAAS;AAOrD,SAAK,WAAW,IAAI,eAAgB;AAAA,MAEnC,MAAM,OAAO;AAAA,MACb,UAAU,KAAK;AAAA,MACf,cAAc,OAAO;AAAA,MACrB,gBAAgB,OAAO;AAAA,IAExB,CAAE;AAEF,SAAK,SAAS,UAAU,QAAQ;AAChC,SAAK,SAAS,UAAU,QAAQ;AAIhC,SAAK,UAAU,IAAI,eAAgB,KAAK,QAAS;AAAA,EAElD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,OAAQ,UAAU,aAAa,YAAY,WAA8B;AAExE,SAAK,SAAU,UAAW,EAAE,QAAQ,WAAW;AAC/C,SAAK,SAAU,MAAO,EAAE,SAAS;AAEjC,QAAK,KAAK,gBAAiB;AAE1B,eAAS,gBAAiB,IAAK;AAC/B,WAAK,QAAQ,OAAQ,QAAS;AAAA,IAE/B,OAAO;AAEN,eAAS,gBAAiB,WAAY;AACtC,UAAK,KAAK,MAAQ,UAAS,MAAM;AACjC,WAAK,QAAQ,OAAQ,QAAS;AAAA,IAE/B;AAAA,EAED;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU;AAET,SAAK,SAAS,QAAQ;AAEtB,SAAK,QAAQ,QAAQ;AAAA,EAEtB;AAED;",
  "names": []
}
